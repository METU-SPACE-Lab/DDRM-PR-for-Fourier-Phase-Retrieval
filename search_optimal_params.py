import subprocess
import numpy as np
import re

print("eta, \t etaB, \t num_avg_samples, \t timesteps: \t  \t hio \t \t diff")
for eta in np.arange(0.7, 1.0, 0.08):
    for etaB in np.arange(0.07, eta * 2 / 3, 0.1):
        for num_avg_samples in range(1, 21, 3):
            for timesteps in range(15, 36, 3):
                command = f"python main.py --ni --config celeba_pr.yml --doc celeba -i celeba --deg pr --num_avg_samples {num_avg_samples} --eta {eta} --etaB {etaB} --timesteps {timesteps}"

                hio_psnr = 0
                diff_psnr = 0
                MONTE_CARLO = 1
                for monte_carlo_step in range(MONTE_CARLO):
                    output = subprocess.getoutput(command)

                    hio_psnr += float(
                        re.findall("Total Average PSNR of JPEG: (.*)", output)[0]
                    )
                    diff_psnr += float(
                        re.findall("Total Average PSNR: (.*)", output)[0]
                    )
                hio_psnr /= MONTE_CARLO
                diff_psnr /= MONTE_CARLO
                
                # print(output)
                print(
                    f"{eta}, \t {etaB}, \t {num_avg_samples}, \t {timesteps}: \t  \t {hio_psnr} \t \t {diff_psnr}"
                )


# eta      etaB    numAvgS timesteps       hio             diff
# 0.45,    0.0,    1,      18:             24.08           21.29
# 0.45,    0.0,    1,      19:             24.3            21.18
# 0.45,    0.0,    1,      20:             24.3            21.18
# 0.45,    0.0,    1,      21:             23.98           20.97
# 0.45,    0.0,    1,      22:             23.63           20.56
# 0.45,    0.0,    1,      23:             23.63           20.56
# 0.45,    0.0,    1,      24:             24.16           20.87
# 0.45,    0.0,    1,      25:             24.16           20.87
# 0.45,    0.0,    1,      26:             23.99           20.32
# 0.45,    0.0,    1,      27:             23.99           20.32
# 0.45,    0.0,    1,      28:             24.16           20.38
# 0.45,    0.0,    1,      29:             24.16           20.38
# 0.45,    0.0,    1,      30:             24.16           20.38
# 0.45,    0.0,    1,      31:             23.73           19.74
# 0.45,    0.0,    1,      32:             23.73           19.74
# 0.45,    0.0,    1,      33:             23.73           19.74
# 0.45,    0.0,    1,      34:             23.89           19.35
# 0.45,    0.0,    1,      35:             23.89           19.35
# 0.45,    0.0,    2,      15:             24.16           22.11
# 0.45,    0.0,    2,      16:             23.73           21.66
# 0.45,    0.0,    2,      17:             23.99           21.66
# 0.45,    0.0,    2,      18:             23.89           21.4
# 0.45,    0.0,    2,      19:             24.0            21.5
# 0.45,    0.0,    2,      20:             24.0            21.5
# 0.45,    0.0,    2,      21:             23.95           21.1
# 0.45,    0.0,    2,      22:             23.91           20.97
# 0.45,    0.0,    2,      23:             23.91           20.97
# 0.45,    0.0,    2,      24:             24.12           21.0
# 0.45,    0.0,    2,      25:             24.12           21.0
# 0.45,    0.0,    2,      26:             23.89           20.61
# 0.45,    0.0,    2,      27:             23.89           20.61
# 0.45,    0.0,    2,      28:             23.32           20.25
# 0.45,    0.0,    2,      29:             23.32           20.25
# 0.45,    0.0,    2,      30:             23.32           20.25
# 0.45,    0.0,    2,      31:             23.89           20.02
# 0.45,    0.0,    2,      32:             23.89           20.02
# 0.45,    0.0,    2,      33:             23.89           20.02
# 0.45,    0.0,    2,      34:             23.91           19.75
# 0.45,    0.0,    2,      35:             23.91           19.75
# 0.45,    0.0,    3,      15:             23.84           22.08
# 0.45,    0.0,    3,      16:             24.5            21.95
# 0.45,    0.0,    3,      17:             23.92           21.73
# 0.45,    0.0,    3,      18:             23.31           21.24
# 0.45,    0.0,    3,      19:             23.32           21.23
# 0.45,    0.0,    3,      20:             23.32           21.23
# 0.45,    0.0,    3,      21:             24.05           21.22
# 0.45,    0.0,    3,      22:             23.38           20.64
# 0.45,    0.0,    3,      23:             23.38           20.64
# 0.45,    0.0,    3,      24:             23.81           20.95
# 0.45,    0.0,    3,      25:             23.81           20.95
# 0.45,    0.0,    3,      26:             24.1            20.68
# 0.45,    0.0,    3,      27:             24.1            20.68
# 0.45,    0.0,    3,      28:             23.79           20.37
# 0.45,    0.0,    3,      29:             23.79           20.37
# 0.45,    0.0,    3,      30:             23.79           20.37
# 0.45,    0.0,    3,      31:             24.11           20.09
# 0.45,    0.0,    3,      32:             24.11           20.09
# 0.45,    0.0,    3,      33:             24.11           20.09
# 0.45,    0.0,    3,      34:             23.83           19.63
# 0.45,    0.0,    3,      35:             23.83           19.63
# 0.45,    0.0,    4,      15:             23.32           21.83
# 0.45,    0.0,    4,      16:             23.89           21.82
# 0.45,    0.0,    4,      17:             23.38           21.29
# 0.45,    0.0,    4,      18:             23.91           21.64
# 0.45,    0.0,    4,      19:             23.36           21.3
# 0.45,    0.0,    4,      20:             23.36           21.3
# 0.45,    0.0,    4,      21:             24.22           21.16
# 0.45,    0.0,    4,      22:             23.28           20.82
# 0.45,    0.0,    4,      23:             23.28           20.82
# 0.45,    0.0,    4,      24:             24.3            20.97
# 0.45,    0.0,    4,      25:             24.3            20.97
# 0.45,    0.0,    4,      26:             23.49           20.52
# 0.45,    0.0,    4,      27:             23.49           20.52
# 0.45,    0.0,    4,      28:             23.81           20.53
# 0.45,    0.0,    4,      29:             23.81           20.53
# 0.45,    0.0,    4,      30:             23.81           20.53
# 0.45,    0.0,    4,      31:             23.99           20.17
# 0.45,    0.0,    4,      32:             23.99           20.17
# 0.45,    0.0,    4,      33:             23.99           20.17
# 0.45,    0.0,    4,      34:             23.74           19.78
# 0.45,    0.0,    4,      35:             23.74           19.78
# 0.45,    0.0,    5,      15:             23.81           22.17
# 0.45,    0.0,    5,      16:             23.51           21.78
# 0.45,    0.0,    5,      17:             23.79           21.53
# 0.45,    0.0,    5,      18:             24.09           21.45
# 0.45,    0.0,    5,      19:             24.3            21.49
# 0.45,    0.0,    5,      20:             24.3            21.49
# 0.45,    0.0,    5,      21:             24.01           21.3
# 0.45,    0.0,    5,      22:             23.81           21.02
# 0.45,    0.0,    5,      23:             23.81           21.02
# 0.45,    0.0,    5,      24:             24.17           21.13
# 0.45,    0.0,    5,      25:             24.17           21.13
# 0.45,    0.0,    5,      26:             23.92           20.69
# 0.45,    0.0,    5,      27:             23.92           20.69
# 0.45,    0.0,    5,      28:             23.85           20.49
# 0.45,    0.0,    5,      29:             23.85           20.49
# 0.45,    0.0,    5,      30:             23.85           20.49
# 0.45,    0.0,    5,      31:             23.75           20.09
# 0.45,    0.0,    5,      32:             23.75           20.09
# 0.45,    0.0,    5,      33:             23.75           20.09
# 0.45,    0.0,    5,      34:             23.83           19.86
# 0.45,    0.0,    5,      35:             23.83           19.86
# 0.45,    0.0,    6,      15:             23.79           22.01
# 0.45,    0.0,    6,      16:             24.11           21.9
# 0.45,    0.0,    6,      17:             23.9            21.58
# 0.45,    0.0,    6,      18:             23.83           21.47
# 0.45,    0.0,    6,      19:             23.81           21.54
# 0.45,    0.0,    6,      20:             23.81           21.54
# 0.45,    0.0,    6,      21:             24.05           21.32
# 0.45,    0.0,    6,      22:             23.89           20.9


# eta,     etaB,   num_avg_samples,        timesteps:              hio             diff
# 0.7,     0.07,   1,      15:             23.84           23.76
# 0.7,     0.07,   1,      18:             24.08           23.94
# 0.7,     0.07,   1,      21:             23.98           23.99
# 0.7,     0.07,   1,      24:             24.16           24.26
# 0.7,     0.07,   1,      27:             23.99           24.1
# 0.7,     0.07,   1,      30:             24.16           24.34
# 0.7,     0.07,   1,      33:             23.73           24.15
# 0.7,     0.07,   4,      15:             23.32           23.59
# 0.7,     0.07,   4,      18:             23.91           24.07
# 0.7,     0.07,   4,      21:             24.22           24.09
# 0.7,     0.07,   4,      24:             24.3            24.25
# 0.7,     0.07,   4,      27:             23.49           23.81
# 0.7,     0.07,   4,      30:             23.81           24.27
# 0.7,     0.07,   4,      33:             23.99           24.45
# 0.7,     0.07,   7,      15:             24.1            24.15
# 0.7,     0.07,   7,      18:             24.08           24.15
# 0.7,     0.07,   7,      21:             23.76           23.92
# 0.7,     0.07,   7,      24:             24.0            24.19
# 0.7,     0.07,   7,      27:             24.06           24.31
# 0.7,     0.07,   7,      30:             23.86           24.35
# 0.7,     0.07,   7,      33:             24.38           24.62
# 0.7,     0.07,   10,     15:             23.85           24.02
# 0.7,     0.07,   10,     18:             23.83           24.07
# 0.7,     0.07,   10,     21:             23.42           23.64
# 0.7,     0.07,   10,     24:             23.71           23.96
# 0.7,     0.07,   10,     27:             24.1            24.32
# 0.7,     0.07,   10,     30:             23.65           24.21
# 0.7,     0.07,   10,     33:             23.8            24.37
# 0.7,     0.07,   13,     15:             23.94           24.13
# 0.7,     0.07,   13,     18:             23.34           23.72
# 0.7,     0.07,   13,     21:             23.75           23.93
# 0.7,     0.07,   13,     24:             24.03           24.17
# 0.7,     0.07,   13,     27:             24.04           24.32
# 0.7,     0.07,   13,     30:             23.98           24.42
# 0.7,     0.07,   13,     33:             22.94           23.78
# 0.7,     0.07,   16,     15:             23.83           24.07
# 0.7,     0.07,   16,     18:             23.86           23.95
# 0.7,     0.07,   16,     21:             23.87           24.13
# 0.7,     0.07,   16,     24:             23.78           24.04
# 0.7,     0.07,   16,     27:             24.0            24.28
# 0.7,     0.07,   16,     30:             23.43           23.9
# 0.7,     0.07,   16,     33:             23.84           24.35
# 0.7,     0.07,   19,     15:             23.86           23.99
# 0.7,     0.07,   19,     18:             23.55           23.88
# 0.7,     0.07,   19,     21:             22.76           23.06
# 0.7,     0.07,   19,     24:             24.24           24.38
# 0.7,     0.07,   19,     27:             23.17           23.52
